"use strict";var app=angular.module("googApp",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("home",{url:"/",templateUrl:"/html/home.html",controller:"homeCtrl"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}),o.otherwise("/")}]),app.run(["AuthService",function(e){e.init()}]);var app=angular.module("googApp");app.controller("homeCtrl",["$scope","AuthService","NavService","UserService","InstaService",function(e,o,n,t,r){function a(){var o={zoom:4,center:new google.maps.LatLng(40,-98),mapTypeId:google.maps.MapTypeId.TERRAIN};e.map=new google.maps.Map(document.getElementById("map"),o),e.markers=[];for(var n=new google.maps.InfoWindow,t=function(o){var t=new google.maps.Marker({map:e.map,position:new google.maps.LatLng(o.lat,o.lng),title:o.address});t.content='<div class="infoWindowContent">PICTURE!</div>',google.maps.event.addListener(t,"click",function(){n.setContent("<h2>"+t.title+"</h2>"+t.content),n.open(e.map,t)}),e.markers.push(t)},r=0;r<e.locations.length;r++)t(e.locations[r])}function i(){var o={zoom:4,center:new google.maps.LatLng(40,-98),mapTypeId:google.maps.MapTypeId.TERRAIN};e.map=new google.maps.Map(document.getElementById("map"),o);for(var n=new google.maps.InfoWindow,t=function(o){var t=new google.maps.Marker({map:e.map,position:new google.maps.LatLng(o.lat,o.lng),title:o.address});t.content='<img class="infoWindowContent" src=\''+o.image+"'></img>",google.maps.event.addListener(t,"click",function(){n.setContent("<h2>"+t.title+"</h2>"+t.content),n.open(e.map,t)}),e.markers.push(t)},r=0;r<e.instagram.length;r++)console.log(e.instagram[r]),t(e.instagram[r])}e.$watch(function(){return t.locations},function(o){e.locations=o,a()}),e.$watch(function(){return r.instagram},function(o){e.instagram=o,i()}),e.openInfoWindow=function(e,o){e.preventDefault(),google.maps.event.trigger(o,"click")},e.openInfoWindow=function(e,o){e.preventDefault(),google.maps.event.trigger(o,"click")}}]);var app=angular.module("googApp");app.controller("loginCtrl",["$scope","$state","AuthService",function(e,o,n){e.login=function(e){n.login(e).then(function(e){o.go("home")},function(e){console.error("err: ",e)})},e.register=function(e){n.register(e).then(function(e){o.go("home")},function(e){console.error("err: ",e)})}}]);var app=angular.module("googApp");app.controller("navCtrl",["$scope","UserService","AuthService","NavService",function(e,o,n,t){e.$watch(function(){return o.user},function(o){e.username=o.username,e.locations=o.locations}),e.logout=function(){n.logout(),e.username=null,e.locations=null},e.getCoords=function(){t.getCoords(e.location.address)},e.removeLocation=function(e){t.removeLocation(e)},e.getPhotos=function(){console.log("works"),t.getPhotos().then(function(e){console.log(e)},function(e){return console.error(e)})}}]);var app=angular.module("googApp");app.service("AuthService",["$http","$state","UserService",function(e,o,n){this.logout=function(){e["delete"]("/users/authenticate").then(function(e){n.destroy(),o.go("home")})},this.register=function(o){return e.post("/users/register",o).then(function(e){return n.set(e.data),e.data},function(e){return console.error(e)})},this.login=function(o){return e.post("/users/authenticate",o).then(function(e){return n.set(e.data),e.data},function(e){return console.error(e)})},this.init=function(){return e.get("/users/profile").then(function(e){return n.set(e.data),e.data},function(e){return console.error(e)})}}]);var app=angular.module("googApp");app.service("InstaService",function(){this.set=function(e){console.log(e),this.instagram=e.map(function(e){if(e.location){var o={image:e.images.low_resolution.url,address:e.location.name,lat:e.location.latitude,lng:e.location.longitude};return o}}).filter(function(e){return e?e:void 0})},this.destroy=function(){this.instagram=null}});var app=angular.module("googApp");app.service("UserService",function(){this.set=function(e){this.locations=e.locations,this.username=e.username,this._id=e._id,this.user=e},this.destroy=function(){this.locations=null,this.username=null,this._id=null}});var app=angular.module("googApp");app.service("NavService",["$http","UserService","InstaService",function(e,o,n){this.getCoords=function(n){function t(){var t=new google.maps.Geocoder;t.geocode({address:n},function(n,t){if(t===google.maps.GeocoderStatus.OK){var r={address:n[0].formatted_address,lat:n[0].geometry.location.lat(),lng:n[0].geometry.location.lng()};return e.post("/users/locations",r).then(function(e){return o.set(e.data),e.data},function(e){console.error("err: ",e)})}alert("Geocode was not successful for the following reason: "+t)})}t()},this.removeLocation=function(n){e["delete"]("/users/locations/"+n.address).then(function(e){return o.set(e.data)},function(e){return console.error(e)})},this.getPhotos=function(){return e.get("/users/instagram").then(function(e){return n.set(e.data.data)},function(e){return console.error(e)})}}]);
//# sourceMappingURL=bundle.js.map
